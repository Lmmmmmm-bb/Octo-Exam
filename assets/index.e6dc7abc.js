import{d as y,o as v,m as C,n as w,f as x,e as F,q as k,a6 as L,a1 as b,u as e,c as T,w as p,a,aA as l,aB as I,P as $,aC as V,a2 as P,G as A,V as U,B as q,a3 as j,a9 as M,L as N}from"./vendor.6972e5cc.js";/* empty css                *//* empty css              *//* empty css              *//* empty css               *//* empty css                    *//* empty css                */import{_ as H}from"./index.2a47b881.js";import{w as O,_ as D,a as G}from"./index.4b3eb2e7.js";/* empty css                 *//* empty css            *//* empty css               */import{u as z}from"./useToggle.a37816a2.js";import{h as _}from"./index.28af6cb6.js";import{_ as W}from"./index.70b05ec0.js";import{r as J}from"./refresh.f69c740e.js";import{_ as K}from"./plugin-vue_export-helper.1c6f6f40.js";/* empty css               */const Q=y({name:"Search"}),X={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},Y=w("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704z"},null,-1),Z=[Y];function ee(E,n,d,m,h,r){return v(),C("svg",X,Z)}var te=K(Q,[["render",ee]]);const ae=[{text:"\u6210\u7EE9\u7BA1\u7406"},{text:"\u6210\u7EE9\u5217\u8868"}],oe="/score",ne="/scores",R="/score",re=`${oe}/exam`,se={class:"w-full flex justify-center items-center flex-col"},ce=A("\u5220\u9664"),ue=y({props:{isHidePagination:{type:Boolean}},setup(E,{expose:n}){const d=E,m=x([]),{isActive:h,onToggle:r}=z(),c=F({total:0,data:[]}),u=F({current:1,pageSize:10}),i=async()=>{try{r();const{data:t}=await _.getRequest(ne,{params:{page:u.current,pageSize:u.pageSize}}),{list:o,total:S}=t;c.data=o,c.total=S}catch{}finally{r()}},B=async t=>{try{r();const{data:o}=await _.getRequest(`${re}/${t}`);c.data=o,c.total=o.length}catch{}finally{r()}},g=t=>m.value=t,s=async t=>{try{await _.deleteRequest(R,{params:{list:t.scoreId}}),await i()}catch{}return!0};return n({selectedRows:m,onFetchScore:i,onFetchScoreByExamCode:B}),k(()=>{i()}),(t,o)=>{const S=L("loading");return v(),C("div",se,[b((v(),T(e(V),{"empty-text":"\u6682\u65E0\u6210\u7EE9\u6570\u636E",size:"large","row-key":"scoreId",data:e(c).data,"highlight-current-row":"",onSelectionChange:g},{default:p(()=>[a(e(l),{type:"selection",width:"50",align:"center"}),a(e(l),{label:"\u8003\u751F\u53F7",prop:"studentId"}),a(e(l),{label:"\u8003\u8BD5\u7F16\u53F7",prop:"examCode"}),a(e(l),{label:"\u79D1\u76EE",prop:"subject"}),a(e(l),{label:"\u5206\u6570",prop:"score"}),a(e(l),{label:"\u63D0\u4EA4\u65F6\u95F4",prop:"answerDate"}),a(e(l),{label:"\u64CD\u4F5C"},{default:p(f=>[a(e(I),{icon:e(O),"icon-color":"red",title:"\u786E\u5B9A\u8981\u5220\u9664\u8BE5\u6210\u7EE9\u5417","confirm-button-text":"\u786E\u5B9A","cancel-button-text":"\u53D6\u6D88",onConfirm:de=>s(f.row)},{reference:p(()=>[a(e($),{size:"small",type:"danger",plain:""},{default:p(()=>[ce]),_:1})]),_:2},1032,["icon","onConfirm"])]),_:1})]),_:1},8,["data"])),[[S,e(h)]]),b(a(W,{"current-page":e(u).current,"onUpdate:current-page":o[0]||(o[0]=f=>e(u).current=f),"page-size":e(u).pageSize,"onUpdate:page-size":o[1]||(o[1]=f=>e(u).pageSize=f),class:"mt-4",total:e(c).total,onPageChange:i},null,8,["current-page","page-size","total"]),[[P,d.isHidePagination]])])}}}),le={class:"outerWrapper"},ie={class:"w-full flex justify-between mb-2"},pe=A(" \u641C \u7D22 "),ze=y({setup(E){const n=x(),{isActive:d,onActive:m,onUnActive:h}=z(),r=x(""),c=U(()=>n.value?n.value.selectedRows.length===0:!0),u=()=>{h(),n.value&&n.value.onFetchScore()},i=()=>{if(n.value){const{onFetchScore:s,onFetchScoreByExamCode:t}=n.value;r.value.trim().length===0?s():(m(),t(r.value))}},B=async()=>{if(n.value){const s=n.value.selectedRows;M.confirm(`\u786E\u5B9A\u8981\u5220\u9664 ${s.length} \u4F4D\u5B66\u751F\u5417\uFF1F`,"\u63D0\u793A",{cancelButtonText:"\u53D6\u6D88",confirmButtonText:"\u786E\u5B9A"}).then(async()=>{const t=s.map(o=>o.scoreId.toString());await _.deleteRequest(R,{params:{list:t.join(",")}}),g()})}},g=()=>{if(n.value){const{onFetchScore:s,onFetchScoreByExamCode:t}=n.value;d.value?t(r.value):s()}};return(s,t)=>(v(),C("div",le,[a(H,{path:e(ae)},null,8,["path"]),a(e(q)),w("div",ie,[a(e(j),{size:"large"},{default:p(()=>[a(e(N),{modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=o=>r.value=o),placeholder:"\u901A\u8FC7\u8003\u8BD5\u7F16\u53F7\u67E5\u8BE2",clearable:"",onClear:u},null,8,["modelValue"]),a(e($),{type:"primary",icon:e(te),onClick:i},{default:p(()=>[pe]),_:1},8,["icon"])]),_:1}),w("div",null,[a(D,{icon:e(G),disabled:e(c),type:"danger",content:"\u6279\u91CF\u5220\u9664",onOnClick:B},null,8,["icon","disabled"]),a(D,{icon:e(J),type:"primary",content:"\u70B9\u51FB\u5237\u65B0",onOnClick:g},null,8,["icon"])])]),a(ue,{ref_key:"tableRef",ref:n,"is-hide-pagination":!e(d)},null,8,["is-hide-pagination"])]))}});export{ze as default};
