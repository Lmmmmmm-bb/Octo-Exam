import{d as B,o as x,n as E,p as w,f as C,e as $,s as A,ab as U,a6 as z,u as e,c as V,w as d,a as o,aD as p,aE as j,Q as D,H as I,I as k,aF as M,a7 as P,W as q,C as N,a8 as H,ae as O,M as W}from"./vendor.95b19c0f.js";/* empty css                *//* empty css              *//* empty css              *//* empty css               *//* empty css                    *//* empty css                */import{_ as Q}from"./index.2c6f5079.js";import{w as G,_ as R,a as J}from"./index.e272d47c.js";/* empty css                 *//* empty css            *//* empty css                *//* empty css               */import{u as F}from"./useToggle.abd91655.js";import{u as L}from"./useLocale.9d078016.js";import{h as v,R as K}from"./index.f787b2ac.js";import{_ as X}from"./index.493e4c04.js";import{r as Y}from"./refresh.21f25757.js";import{_ as Z}from"./plugin-vue_export-helper.1c6f6f40.js";/* empty css               */const ee=B({name:"Search"}),te={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},oe=w("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704z"},null,-1),ae=[oe];function ne(y,c,r,a,f,g){return x(),E("svg",te,ae)}var re=Z(ee,[["render",ne]]);const ce="/score",se="/scores",T="/score",le=`${ce}/exam`,ie={class:"w-full flex justify-center items-center flex-col"},me=B({props:{isHidePagination:{type:Boolean}},setup(y,{expose:c}){const r=y,{t:a}=L(),f=C([]),{isActive:g,onToggle:s}=F(),l=$({total:0,data:[]}),i=$({current:1,pageSize:10}),u=async()=>{try{s();const{data:t}=await v.getRequest(se,{params:{page:i.current,pageSize:i.pageSize}}),{list:n,total:b}=t;l.data=n,l.total=b}catch{}finally{s()}},S=async t=>{try{s();const{data:n}=await v.getRequest(`${le}/${t}`);l.data=n,l.total=n.length}catch{}finally{s()}},_=t=>f.value=t,m=async t=>{try{await v.deleteRequest(T,{params:{list:t.scoreId}}),await u()}catch{}return!0};return c({selectedRows:f,onFetchScore:u,onFetchScoreByExamCode:S}),A(()=>{u()}),(t,n)=>{const b=U("loading");return x(),E("div",ie,[z((x(),V(e(M),{"empty-text":e(a)("score.empty"),size:"large","row-key":"scoreId",data:e(l).data,"highlight-current-row":"",onSelectionChange:_},{default:d(()=>[o(e(p),{type:"selection",width:"50",align:"center"}),o(e(p),{label:e(a)("profile.studentId"),prop:"studentId"},null,8,["label"]),o(e(p),{label:e(a)("exam.code"),prop:"examCode"},null,8,["label"]),o(e(p),{label:e(a)("score.subject"),prop:"subject"},null,8,["label"]),o(e(p),{label:e(a)("score.score"),prop:"score"},null,8,["label"]),o(e(p),{label:e(a)("score.date"),prop:"answerDate"},null,8,["label"]),o(e(p),{label:e(a)("common.operate")},{default:d(h=>[o(e(j),{icon:e(G),"icon-color":"red",title:e(a)("score.deleteComfirm"),"confirm-button-text":e(a)("common.confirm"),"cancel-button-text":e(a)("common.cancel"),onConfirm:de=>m(h.row)},{reference:d(()=>[o(e(D),{size:"small",type:"danger",plain:""},{default:d(()=>[I(k(e(a)("common.delete")),1)]),_:1})]),_:2},1032,["icon","title","confirm-button-text","cancel-button-text","onConfirm"])]),_:1},8,["label"])]),_:1},8,["empty-text","data"])),[[b,e(g)]]),z(o(X,{"current-page":e(i).current,"onUpdate:current-page":n[0]||(n[0]=h=>e(i).current=h),"page-size":e(i).pageSize,"onUpdate:page-size":n[1]||(n[1]=h=>e(i).pageSize=h),class:"mt-4",total:e(l).total,onPageChange:u},null,8,["current-page","page-size","total"]),[[P,r.isHidePagination]])])}}}),pe={class:"outerWrapper"},ue={class:"w-full flex justify-between mb-2"},Le=B({setup(y){const{t:c}=L(),r=C(),{isActive:a,onActive:f,onUnActive:g}=F(),s=C(""),l=q(()=>r.value?r.value.selectedRows.length===0:!0),i=()=>{g(),r.value&&r.value.onFetchScore()},u=()=>{if(r.value){const{onFetchScore:m,onFetchScoreByExamCode:t}=r.value;s.value.trim().length===0?m():(f(),t(s.value))}},S=async()=>{if(r.value){const m=r.value.selectedRows;O.confirm(c("exam.deleteConfirm"),c("common.tip"),{cancelButtonText:c("common.cancel"),confirmButtonText:c("common.confirm")}).then(async()=>{const t=m.map(n=>n.scoreId.toString());await v.deleteRequest(T,{params:{list:t.join(",")}}),_()})}},_=()=>{if(r.value){const{onFetchScore:m,onFetchScoreByExamCode:t}=r.value;a.value?t(s.value):m()}};return(m,t)=>(x(),E("div",pe,[o(Q,{path:[{text:e(c)(`menu.${e(K).ScoreManage}`)}]},null,8,["path"]),o(e(N)),w("div",ue,[o(e(H),{size:"large"},{default:d(()=>[o(e(W),{modelValue:s.value,"onUpdate:modelValue":t[0]||(t[0]=n=>s.value=n),placeholder:e(c)("score.searchByCode"),clearable:"",onClear:i},null,8,["modelValue","placeholder"]),o(e(D),{type:"primary",icon:e(re),onClick:u},{default:d(()=>[I(k(e(c)("common.search")),1)]),_:1},8,["icon"])]),_:1}),w("div",null,[o(R,{icon:e(J),disabled:e(l),type:"danger",content:e(c)("common.delete"),onOnClick:S},null,8,["icon","disabled","content"]),o(R,{icon:e(Y),type:"primary",content:e(c)("common.refresh"),onOnClick:_},null,8,["icon","content"])])]),o(me,{ref_key:"tableRef",ref:r,"is-hide-pagination":!e(a)},null,8,["is-hide-pagination"])]))}});export{Le as default};
